#include <xc.h>
#include "configs.h"

const unsigned int digitos [11][22] = {
	{0x07E0,0x0FF0,0x1008,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x1008,0x0FF0,0x07E0},	// 0
	{0x0780,0x0780,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x1FF8,0x1FF8},	// 1
	{0x07E0,0x0FF0,0x1008,0x000C,0x0006,0x0006,0x0006,0x000C,0x001C,0x0038,0x0070,0x00E0,0x01C0,0x0380,0x0700,0x0E00,0x1C00,0x1800,0x3000,0x3000,0x3FFE,0x3FFE},	// 2
	{0x1FF0,0x3FF8,0x601C,0x000C,0x000C,0x000C,0x000C,0x000C,0x000C,0x0018,0x07F0,0x07F0,0x0018,0x000C,0x000C,0x000C,0x000C,0x000C,0x000C,0x601C,0x3FF8,0x1FF0},	// 3
	{0x0000,0x000C,0x001C,0x003C,0x006C,0x00CC,0x018C,0x030C,0x060C,0x0C0C,0x180C,0x300C,0x3FFE,0x3FFE,0x000C,0x000C,0x000C,0x000C,0x000C,0x000C,0x000C,0x000C},	// 4
	{0x7FF8,0x7FF8,0x6000,0x6000,0x6000,0x6000,0x6000,0x6000,0x6000,0x6000,0x7FF0,0x7FF8,0x000C,0x000C,0x000C,0x000C,0x000C,0x000C,0x000C,0x000C,0x7FF8,0x7FF0},	// 5
	{0x0FF0,0x1FF0,0x3000,0x6000,0x6000,0x6000,0x6000,0x6000,0x6000,0x6000,0x6FF0,0x7FF8,0x700C,0x600C,0x600C,0x600C,0x600C,0x600C,0x600C,0x600C,0x3FF8,0x1FF0},	// 6
	{0x3FFC,0x3FFC,0x000C,0x000C,0x0018,0x0018,0x0030,0x0030,0x0060,0x0060,0x00C0,0x00C0,0x0180,0x0180,0x0300,0x0300,0x0600,0x0600,0x0C00,0x0C00,0x1800,0x1800},	// 7
	{0x07E0,0x0FF0,0x1008,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x1818,0x0FF0,0x0FF0,0x1818,0x300C,0x300C,0x300C,0x300C,0x300C,0x300C,0x1008,0x0FF0,0x07E0},	// 8
	{0x07F8,0x1FFC,0x180C,0x3006,0x3006,0x3006,0x3006,0x3006,0x3006,0x180E,0x1FFE,0x07F6,0x0006,0x0006,0x0006,0x0006,0x0006,0x0006,0x000C,0x0018,0x0FF0,0x0FE0},	// 9
	{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}	// blank
};

const char texto[44][8] = {
	{0x00, 0x7E, 0xA1, 0x91, 0x89, 0x85, 0x7E, 0x00},  // Code for char 0
	{0x00, 0x00, 0x82, 0xFF, 0x80, 0x00, 0x00, 0x00},  // Code for char 1
	{0x00, 0xC2, 0xA1, 0x91, 0x89, 0x86, 0x00, 0x00},  // Code for char 2
	{0x00, 0x00, 0x81, 0x81, 0x89, 0x95, 0x63, 0x00},  // Code for char 3
	{0x00, 0x00, 0x18, 0x14, 0x12, 0xFF, 0x10, 0x00},  // Code for char 4
	{0x00, 0x8F, 0x89, 0x89, 0x89, 0x89, 0x70, 0x00},  // Code for char 5
	{0x00, 0x7E, 0x89, 0x89, 0x89, 0x89, 0x70, 0x00},  // Code for char 6
	{0x00, 0x01, 0xC1, 0x31, 0x09, 0x05, 0x03, 0x00},  // Code for char 7
	{0x00, 0x76, 0x89, 0x89, 0x89, 0x76, 0x00, 0x00},  // Code for char 8
	{0x00, 0x0E, 0x91, 0x91, 0x91, 0x7E, 0x00, 0x00},  // Code for char 9
	{0x00, 0x00, 0x00, 0xCC, 0xCC, 0x00, 0x00, 0x00},  // Code for char :	10
	{0x00, 0x00, 0x48, 0x48, 0x48, 0x48, 0x00, 0x00},  // Code for char =	11
	{0x00, 0xFC, 0x12, 0x11, 0x12, 0xFC, 0x00, 0x00},  // Code for char A	12
	{0x00, 0xFF, 0x89, 0x89, 0x89, 0x76, 0x00, 0x00},  // Code for char B	13
	{0x00, 0x7E, 0x81, 0x81, 0x81, 0x81, 0x00, 0x00},  // Code for char C	14
	{0x00, 0xFF, 0x81, 0x81, 0x81, 0x81, 0x7E, 0x00},  // Code for char D	15
	{0x00, 0xFF, 0x89, 0x89, 0x89, 0x81, 0x00, 0x00},  // Code for char E	16
	{0x00, 0xFF, 0x09, 0x09, 0x09, 0x01, 0x00, 0x00},  // Code for char F	17
	{0x00, 0x7E, 0x81, 0x91, 0x91, 0xF0, 0x00, 0x00},  // Code for char G	18
	{0x00, 0xFF, 0x10, 0x10, 0x10, 0xFF, 0x00, 0x00},  // Code for char H	19
	{0x00, 0x00, 0x81, 0xFF, 0x81, 0x00, 0x00, 0x00},  // Code for char I	20
	{0x00, 0x41, 0x81, 0x7F, 0x01, 0x00, 0x00, 0x00},  // Code for char J	21
	{0x00, 0xFF, 0x18, 0x24, 0x42, 0x80, 0x00, 0x00},  // Code for char K	22
	{0x00, 0xFF, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00},  // Code for char L	23
	{0xFF, 0x02, 0x04, 0x08, 0x04, 0x02, 0xFF, 0x00},  // Code for char M	24
	{0x00, 0xFF, 0x06, 0x08, 0x10, 0x60, 0xFF, 0x00},  // Code for char N	25
	{0x00, 0x7E, 0x81, 0x81, 0x81, 0x81, 0x7E, 0x00},  // Code for char O	26
	{0x00, 0xFF, 0x11, 0x11, 0x11, 0x0E, 0x00, 0x00},  // Code for char P	27
	{0x00, 0x7E, 0x81, 0xA1, 0xC1, 0x7E, 0x00, 0x00},  // Code for char Q	28
	{0x00, 0xFF, 0x31, 0x31, 0x51, 0x8E, 0x00, 0x00},  // Code for char R	29
	{0x00, 0x86, 0x89, 0x89, 0x89, 0x71, 0x00, 0x00},  // Code for char S	30
	{0x01, 0x01, 0x01, 0xFF, 0x01, 0x01, 0x01, 0x00},  // Code for char T	31
	{0x00, 0x7F, 0x80, 0x80, 0x80, 0x80, 0x7F, 0x00},  // Code for char U	32
	{0x00, 0x3F, 0x40, 0x80, 0x80, 0x40, 0x3F, 0x00},  // Code for char V	33
	{0x1E, 0x60, 0xC0, 0x30, 0x30, 0xC0, 0x60, 0x1E},  // Code for char W	34
	{0x00, 0x84, 0x48, 0x30, 0x30, 0x48, 0x84, 0x00},   // Code for char X	35
	{0x01, 0x02, 0x04, 0xF8, 0x04, 0x02, 0x01, 0x00},   // Code for char Y	36
	{0x00, 0xC1, 0xA1, 0x91, 0x89, 0x85, 0x83, 0x00},   // Code for char Z	37
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},	// Code for space	38
    {0x00, 0x00, 0x00, 0xC0, 0xC0, 0x00, 0x00, 0x00}    // Code for char .	39
};

#define LCD_RD      LATA5
#define LCD_WR      LATA3     
#define LCD_RS      LATA2        
#define LCD_CS      LATA1       
#define LCD_RST     LATA0
#define BUS         LATB
#define CONTROL     LATA

/**
 * @Summary
 *      Write one byte of data, address must be set first.
 * @param data
 */
void lcd_write_bus (char data);

/**
 * @Summary
 *      Write the operation code of the command.
 * @param cmd
 */
void lcd_write_command (char cmd);

/**
 * @Summary
 *      Set the address range to be written, from (x1,y1) to (x2,y2).
 * @param x1
 * @param y1
 * @param x2
 * @param y2
 */
void lcd_set_address (unsigned int x1, unsigned int y1, unsigned int x2, unsigned int y2);

/**
 * @Summary
 *      Issue the start command, after this pixel information must be sent.
 */
void lcd_memory_start ();

/**
 * @Summary
 *      This function initializes the display by applying a reset and then
 *      issues the configuration commands.
 */
void lcd_init ();

/**
 * @Summary
 *      Set the color of the background, RGB is 5-bit long for red and blue
 *      and 6-bit long for green.
 *      IMPORTANT: it overrides all data on the screen.
 * @param colour
 */
void lcd_set_background(unsigned int color);

/**
 * @Summary
 *      Draws a black pixel at the address (x,y) of the size "size"
 * @param x
 * @param y
 * @param c
 * @param size
 */
void lcd_pix (unsigned int x, unsigned int y, char c, char size);

/**
 * @Summary
 *      Draws a colored pixel at the address (x,y) of the size "size"
 * @param x
 * @param y
 * @param c
 * @param size
 */
void lcd_pix_color (unsigned int x, unsigned int y, char c, char size);

/**
 * @Summary
 *      Show or hide sign
 * @param enable
 */
void lcd_sign (char enable);

/**
 * @Summary
 *      Place of the decimal point
 * @param place
 */
void lcd_point (char place);

/**
 * @Summary
 *      Print a number with sign and previously set decimal point
 * @param number
 */
void lcd_number(signed int number);

/**
 * @Summary
 *      The classic bit test function 
 * @param number
 * @param position
 * @return The result
 */
char bitRead (unsigned int number, unsigned int position);

/**
 * @Summary
 *      Print a text at the specified line
 * @param renglon   The line position
 * @param msjPtr    Pointer to 16 chars long array
 * @param color     0: black; 1: red
 */
void lcd_text (char renglon, char *msjPtr, char color);

/**
 * @Summary
 *      Print a colored text at the specified line
 * @param renglon
 * @param msjPtr
 */
void lcd_text_color (char renglon, char *msjPtr);